<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>

<?php
/**
 * @see Mage_Adminhtml_Block_Catalog_Product
 */
?>

<div class="content-header">
    <h3>Kraken.io Image Optimizer</h3>
</div>

<div id="kraken-optimizer">
    <div class="kraken-small-box media">
        <?php echo $this->getChildHtml('kraken.media') ?>
    </div>
    <div class="kraken-small-box skin">
        <?php echo $this->getChildHtml('kraken.skin') ?>
    </div>
    <div class="kraken-product-box">
        <h3>Product Images</h3>
        <div class="kraken-box-inner cf">
            <p><strong>Your product images are optimized automatically every time Magento generates new cache entries from your product images.</strong></p>
            <p>If you have just installed this plugin, you should flush the cache now so that the newly generated entries are optimized. After this, no further action is required - your existing product images as well as newly added ones will be automatically compressed and optimized.</p>
            <button onclick="confirmSetLocation('Are you sure?', '<?php echo Mage::helper('adminhtml')->getUrl('adminhtml/cache/cleanImages', array('kraken' => true))?>')"><?php echo Mage::helper('adminhtml')->__('Flush Catalog Images Cache') ?></button>
        </div>
    </div>
</div>

<div id="kraken-modal">
    <div id="kraken-modal-close">&times;</div>
    <div id="kraken-modal-content">
        <p>
            <strong id="kraken-modal-head">Now optimizing all your __type__ images...</strong>
        </p>

        <div id="kraken-progress">
            <div id="kraken-progress-bar">
                <div id="kraken-number-progress">0</div>
            </div>
        </div>

        <div id="kraken-count">
            <span id="kraken-current">0</span> of <span id="kraken-total">-</span> images optimized
        </div>

        <button id="kraken-success-close">Close this dialog</button>
    </div>
    <div id="kraken-modal-error"></div>
    <div id="kraken-modal-footer">
        Please do not close this dialog or reload the page until the optimization process has completed.
    </div>
</div>

<script type="text/javascript">
    var requestUrl = '<?php echo Mage::helper('adminhtml')->getUrl('adminhtml/kraken/optimize') ?>';
    var concurrency = '<?php echo Mage::getStoreConfig('welance_kraken/kraken_config/concurrency') ?>';
</script>